\section{Results}\todo{Summerize results}

\todo{Make sections}
\todo{Include tables}

\foreach \dept in {10,20}{
	\foreach \p in {1,2}{
		\begin{table}
			\centering
			\begin{adjustwidth}{-1in}{-1in}
				\resizebox{1.35\textwidth}{!}{
					\input{tables/station_table_\dept cm_p\p}
				}
			\end{adjustwidth}
			\caption{Statitics of the models for depth \dept}
		\end{table}	
	}
}


\todo{En model av gangen}
\subsection{Linear model}

% insert good, bad, avg diff

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_lin_stat_10_Østfold_2022_TJM10.pdf}
		\caption[Best Difference plot of Linear model]{Differnce plot for daily Plauborg model in year 2022 and region Østfold}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_lin_stat_20_Innlandet_2021_TJM20.pdf}
		\caption{Worst plot for Linear Regression model in year 2021 and region Innlandet}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.90\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_lin_stat_10_Trøndelag_2022_TJM10.pdf}
		\caption{Average plot for Linear Regression model in year 2022 and region Trøndelag}
	\end{subfigure}
\end{figure}

% stat

\begin{table}
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_lin_stat_20.tex}
		\caption{Performance table for Linear regression 20cm}
	\end{subtable}
	%\hfill
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_lin_stat_10.tex}
		\caption{Performance table for Linear regression 10cm}
	\end{subtable}
	\caption{Performance table for Linear Regession at 10 cm depth and 20 cm depth.}
\end{table}

% eclipse

\begin{figure}
	\begin{subfigure}{0.45\linewidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_lin_stat_10}
		\caption[Confidence eclipse of Linear Regression 10cm]{The plot shows the ground truth against the predicted value of Linear Regression. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipslinstat10}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_lin_stat_20}
		\caption[Confidence eclipse of Linear regression 20cm]{The plot shows the ground truth against the predicted value of Linear Regression. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipslinstat20}
	\end{subfigure}
	\caption{Plots showing ground truth vs predicted values from the linear Regression models with their 65\%, 95\%, and 99\% conficence eclipses. The conficense eclipses function the same as confidence intervals but in two dimentions, meaning the area covered by the eclipse denotes where one can expect the points to be with a given confidence procence.}
\end{figure}


The linear model scales the air temperature by a single factor making the model follow the form of the air temperature with the exception of Autumn where it diverges until April. After April the model fits better however it still has a high variance through out the years.


\subsection{Plauborg daily}

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_day_stat_10_Østfold_2022_TJM10.pdf}
		\caption[Best Difference plot of daily values Plauborg model]{Differnce plot for daily Plauborg model in year 2022 and region Østfold}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_day_stat_20_Innlandet_2021_TJM20.pdf}
		\caption[Worst Difference plot of daily values Plauborg model]{Worst plot for daily values Plauborg model in year 2021 and region Innlandet}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.90\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_day_stat_10_Trøndelag_2022_TJM10.pdf}
		\caption[Average Difference plot of daily values Plauborg model]{Average plot for daily values Plauborg model in year 2022 and region Trøndelag}
	\end{subfigure}
\end{figure}

% stat

\begin{table}
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_Plauborg_day_stat_20.tex}
		\caption{Performance table for daily values Plauborg model 20cm}
	\end{subtable}
	\vfill
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_Plauborg_day_stat_10.tex}
		\caption{Performance table for Linear regression 10cm}
	\end{subtable}
	\caption{Performance table for daily values Plauborg model at 10 cm depth and 20 cm depth.}
\end{table}

% eclipse

\begin{figure}
	\begin{subfigure}{0.45\linewidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_Plauborg_day_stat_10}
		\caption[Confidence eclipse of daily values Plauborg model 10cm]{The plot shows the ground truth against the predicted value of daily values Plauborg model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsplauborgdaystat10}
	\end{subfigure}
	%\vfill
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_Plauborg_day_stat_20}
		\caption[Confidence eclipse of daily values Plauborg model 20cm]{The plot shows the ground truth against the predicted value of daily values Plauborg model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsplauborgdaystat20}
	\end{subfigure}
	\caption{Plots showing ground truth vs predicted values from the daily values Plauborg models with their 65\%, 95\%, and 99\% conficence eclipses. The conficense eclipses function the same as confidence intervals but in two dimentions, meaning the area covered by the eclipse denotes where one can expect the points to be with a given confidence procence.}
\end{figure}


The Plauborg model follows strongly the soil temperature ant thereby has good prediction, with the exception of a few staitions. There are two stations that does not follow the same trend as the other stations, those are station Fåvang in year 2021 predicting soil temperatures at 10cm (se figure \ref{apx:plots:diffplot:Plauborgday:Innlandet:2022:10} and \ref{apx:plots:diffplot:Plauborgday:Innlandet:2022:20}) and Apelsvoll in year 2022 and year 2021 (se figure \ref{apx:plots:diffplot:Plauborgday:Innlandet:2021:10} and \ref{apx:plots:diffplot:Plauborgday:Innlandet:2022:20}). 

%Talk about Østfold 2021

In the region Østfold year 2021 there is a divergence at predicting the 10 cm soil temperature, this arises as an effect from an old code used to plot the graph of this model. In the old code the NULL values was set by default to 0 meaning when calculation the difference between predicted values and ground truth it in essence created a copy of the air temperature.

\subsection{Plauborg hourly}

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_stat_10_Østfold_2022_TJM10.pdf}
		\caption[Best Difference plot of hourly values Plauborg model]{Differnce plot for hourly Plauborg model in year 2022 and region Østfold}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_stat_20_Innlandet_2021_TJM20.pdf}
		\caption[Worst Difference plot of hourly values Plauborg model]{Worst plot for hourly values Plauborg model in year 2021 and region Innlandet}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.90\textwidth}
		\centering
		\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_Plauborg_stat_10_Trøndelag_2022_TJM10.pdf}
		\caption[Average Difference plot of hourly values Plauborg model]{Average plot for hourly values Plauborg model in year 2022 and region Trøndelag}
	\end{subfigure}
\end{figure}

% stat

\begin{table}
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_Plauborg_stat_20.tex}
		\caption{Performance table for daily values Plauborg model 20cm}
	\end{subtable}
	%\hfill
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_Plauborg_stat_10.tex}
		\caption{Performance table for hourly values Plauborg model 10cm}
	\end{subtable}
	\caption{Performance table for hourly values Plauborg model at 10 cm depth and 20 cm depth.}
\end{table}

% eclipse

\begin{figure}
	\begin{subfigure}{0.6\linewidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_Plauborg_stat_10}
		\caption[Confidence eclipse of hourly values Plauborg model 10cm]{The plot shows the ground truth against the predicted value of hourly values Plauborg model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsplauborgstat10}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.6\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_Plauborg_stat_20}
		\caption[Confidence eclipse of hourly values Plauborg model 20cm]{The plot shows the ground truth against the predicted value of hourly values Plauborg model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsplauborgstat20}
	\end{subfigure}
	\caption{Plots showing ground truth vs predicted values from the hourly values Plauborg models with their 65\%, 95\%, and 99\% conficence eclipses. The conficense eclipses function the same as confidence intervals but in two dimentions, meaning the area covered by the eclipse denotes where one can expect the points to be with a given confidence procence.}
\end{figure}

The hourly Plauborg shows high variance but promising explained variance. During May and April the model shows a rise in prediction difference, likely due to the effect of snow keeping the temperature relative constant and therefore getting a copy-effect of the air temperature.

\subsection{\acrfull{ac:lstm}}

The \acrshort{ac:lstm} shows a great fit to the data with the exception of the May/April month where there is a trend of constant over estimation with a constant value with few stations showing a spike in difference error in April.

\subsection{Bi-Directional \acrfull{ac:lstm}}

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		%\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_l1KerasBiLSTM_stat_10_Østfold_2022_TJM10.pdf}
		\caption[Best Difference plot of BiLSTM model]{Differnce plot for BiLSTM model in year 2022 and region Østfold}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		%\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_l1KerasBiLSTM_stat_20_Innlandet_2021_TJM20.pdf}
		\caption[Worst Difference plot of BiLSTM model]{Worst plot for BiLSTM model in year 2021 and region Innlandet}
	\end{subfigure}
	\hfill
	\begin{subfigure}{0.90\textwidth}
		\centering
		%\includegraphics[width = 0.9\textwidth]{../../results/plots/diffplot_l1KerasBiLSTM_stat_10_Trøndelag_2022_TJM10.pdf}
		\caption[Average Difference plot of BiLSTM model]{Average plot for BiLSTM model in year 2022 and region Trøndelag}
	\end{subfigure}
\end{figure}

% stat

\begin{table}
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_l1KerasBiLSTM_stat_20.tex}
		\caption{Performance table for BiLSTM model 20cm}
	\end{subtable}
	%\hfill
	\begin{subtable}{0.8\textwidth}
		\input{tables/table_l1KerasBiLSTM_stat_10.tex}
		\caption{Performance table for BiLSTM model 10cm}
	\end{subtable}
	\caption{Performance table for BiLSTM model at 10 cm depth and 20 cm depth.}
\end{table}

% eclipse

\begin{figure}
	\begin{subfigure}{0.45\linewidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_l1KerasBiLSTM_stat_10}
		\caption[Confidence eclipse of BiLSTM model 10cm]{The plot shows the ground truth against the predicted value of BiLSTM model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsl1KerasBiLSTMstat10}
	\end{subfigure}
	\vfill
	\begin{subfigure}{0.45\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/conf_elips_l1KerasBiLSTM_stat_20}
		\caption[Confidence eclipse of BiLSTM model 20cm]{The plot shows the ground truth against the predicted value of BiLSTM model. The eclipses demonstrates the 65\% (inner eclipse), 95\% (middle eclipse), and 99\% (outer eclipse) confidence interval for the model.}
		\label{fig:confelipsl1KerasBiLSTMstat20}
	\end{subfigure}
	\caption{Plots showing ground truth vs predicted values from the BiLSTM models with their 65\%, 95\%, and 99\% conficence eclipses. The confidence eclipses function the same as confidence intervals but in two dimensions, meaning the area covered by the eclipse denotes where one can expect the points to be with a given confidence procence.}
\end{figure}

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_l1KerasBiLSTM_stat_10}
		\end{adjustwidth}
		\caption[Epoch graph BiLSTM 10cm]{Graf of BiLSTM 10cm performance per epoch.}
		\label{fig:epochgrafl1KerasBiLSTMstat10}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_l1KerasBiLSTM_stat_20}
		\end{adjustwidth}
		\caption[Epoch graph BiLSTM 20cm]{Graf of BiLSTM 20cm performance per epoch.}
		\label{fig:epochgrafl1KerasBiLSTMstat20}
	\end{subfigure}
	\caption{Performance graphs displaying the developments of Mean Square Error and \acrfull{ac:r2} for each epoch.}
\end{figure}

The \acrshort{ac:lstm} shows a great fit to the data with the exception of the May/April month where there is a high variance in the transition from one month to the other. Østfold does have subpar performance, in particular station Øsaker and Tomb. Those two consistently either over estimate or under estimate the soil temperature compared to the other stations in the same region (Rakkestad, and Rygge). 

\subsection{\acrfull{ac:gru}}

\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_KerasGRU_stat_10}
		\end{adjustwidth}
		\caption[Epoch graph GRU 10cm]{Graf of GRU 10cm performance per epoch.}
		\label{fig:epochgrafKerasGRUstat10}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_KerasGRU_stat_20}
		\end{adjustwidth}
		\caption[Epoch graph GRU 20cm]{Graf of GRU 20cm performance per epoch.}
		\label{fig:epochgrafKerasGRUstat20}
	\end{subfigure}
	\caption{Performance graphs displaying the developments of Mean Square Error and \acrfull{ac:r2} for each epoch.}
\end{figure}

The GRU model demonstrates encouraging outcome with few notable stations and year. One of which is station Øsaker who over estimates the soil temperature at both depth (10 cm and 20 cm). 

All station shows an seasonal sensitivity, as all stations tend to incrementally over estimate in May before falling down towards 0 $\Delta^\circ C$ around April month. 

\subsection{Bi-directional \acrfull{ac:gru}}
\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_KerasBiGRU_stat_10}
		\end{adjustwidth}
		\caption[Epoch graph BiGRU 10cm]{Graf of BiGRU 10cm performance per epoch.}
		\label{fig:epochgrafKerasBiGRUstat10}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{adjustwidth}{-1in}{-1in}
			\includegraphics[width=0.9\linewidth]{../../results/plots/epoch_graf_KerasBiGRU_stat_20}
		\end{adjustwidth}
		\caption[Epoch graph BiGRU 20cm]{Graf of BiGRU 20cm performance per epoch.}
		\label{fig:epochgrafKerasBiGRUstat20}
	\end{subfigure}
	\caption{Performance graphs displaying the developments of Mean Square Error and \acrfull{ac:r2} for each epoch.}
\end{figure}



\subsection{Deep learning models}

\acrshort{ac:lstm} based models has a higher \acrshort{ac:rmse} than the \acrshort{ac:gru} model that performs similary to the Plauborg models in its performance while the rest (BiLSTM, and LSTM) inhibits an Autumn discrepancy, see section \ref{sec:autumn}. However this discrepancy is less prevalent in the more advance models (BiLSTM, and GRU) but still visible compared to the rest of the year.


\begin{figure}[H]
%	\begin{subfigure}{\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth,height=0.3\textheight]{../../results/plots/diffplot_l2KerasBiLSTM_stat_20_Innlandet_2022_TJM20}
		\caption[LSTM TJM10]{LSTM model applied at stations in the region Innlandet in 2022 with 10cm soil temperature as target.}
		\label{fig:diffplotl2kerasbilstmstats10innlandet2022tjm10}
\end{figure}
\begin{figure}
		\centering
		\includegraphics[width=0.8\linewidth,height=0.3\textheight]{../../results/plots/diffplot_KerasGRU_stats_20_Innlandet_2022_TJM20}
		\caption[GRU TJM10]{GRU model applied at staions in the region Innladet in 2022 with 10cm soil temperature as target.}
		\label{fig:diffplotgrustats10innlandet2022tjm10}
\end{figure}
\begin{figure}
		\centering
		\includegraphics[width=0.8\linewidth,height=0.3\textheight]{../../results/plots/diffplot_l1KerasBiLSTM_stat_20_Innlandet_2022_TJM20}
		\caption[BiLSTM TJM10]{BiLSTM applied at stations in the region Innlandet in 2022 with 10cm soil temperature as target.}
		\label{fig:diffplotl1kerasbilstmstats10innlandet2022tjm10}
\end{figure}

The number of epochs was fixed at 10, however the performance graphs shows that after 4 epochs the performance tend to stabilise, and after 6 epochs it becomes small gains in performance. 



