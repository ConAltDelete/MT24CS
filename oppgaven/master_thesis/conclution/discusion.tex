\section{Discussion}\label{sec:discussion}

\subsection{The Autumn discrepancy}\label{sec:autumn}

A phenomenon that arose during performance evaluations was that the linear models struggles with, and that the deep learning models treated differently was Autumn. The difference graphs showed a clear over or under estimation that are larger than $10\sigma$. This discrepancy can be contributed to the intercept coefficient that during low temperature ($<5^\circ C$) giving either an over estimation or an under approximation. Furthermore, when removing the calculation of the intercept the same phenomenon is still precent possibility due to the model adapting better to Summer that has stable temperatures for a longer period than Autumn and Spring.

The deep learning models seems to have learned that there is a difference between winter season and the other seasons, and this effect can be observed in the difference plots in appendix \ref{apx:plots} .  but to a lesser exstent where it overestimates at a few periods during the Mars month. This can be due to snow covering the soil forming an thermal isolator keeping the soil temperature constant while the air temperature is fluctuating at relative normal rates giving the models a false sense of generality when predicting this period, however the GRU model seems to interoperate a sense of season awareness allowing it to have a more constant temperature prediction in the autumn and return to "normal" operation during Summer and Spring. 

\subsubsection{Temperature seasons}

It can be observed that in the "TM vs TJM10" and "TM vs TJM20" that there signs of seasons where in the air temperature range -10 to 10 and the soil temperature 0 to 5 represents winter / snow season, the air temperature range 0 to 20 and soil temperature 5 to 12 represent Autumn / Spring, and the air temperature 5 to 30 and soil temperature 12 to 22 represents Summer. This seems reasonable as when the temperature in the air rises there will be a lag period before the soil temperature gets warmed up to the appropriate temperature. 

It can be observed in the raw data and in the diff plots (see figure \ref{fig:diffplotl1kerasbilstmstats10innlandet2022tjm10} as an example) that the seasons can be shown though the temperatures and stable periods. The flat areas can be explained by snow covers that create a thermal isolation layer that dampens the effect of sudden changes in the air temperature. There exist models in the literature that takes this effect into account\cite{rankinen_simple_2004,stuurop_simulating_2021} to make a more accurate prediction of soil temperature when there is snow present or frozen soil, however these models require knowledge about the soil that gets simulated or some other properties such as the specific heat capacity of the soil being simulated or the water content of the soil. 

\subsection{Regression model performance}

The findings in the results, as detailed in the tables from (\ref{tab:Plauborg:day:20}) to (\ref{tab:linreg:10}), underscore the limitations of predicting soil temperatures without factoring in temporal elements. The study reveals that omitting time from the modelling process leads to inefficiencies and inaccuracies, a conclusion that is shown in the doubling of RMSE and halving of $R^2$, by the basic Linear Regression model compared to the Plauborg models.

This study looked into the adaptability of the original model, which was initially trained for daily mean temperature predictions. The model underwent a shift in coefficients to facilitate hourly forecasts, with the objective of determining whether the foundational formula could maintain its efficacy on smaller timescales, from daily mean values to hourly mean values in this case. A comparative analysis of the outcomes, as presented in tables (\ref{tab:Plauborg:hour:10}) and (\ref{tab:Plauborg:hour:20}), with their daily equivalents, revealed a consistency in values. This consistency suggests that the modelling approach introduced by Plauborg in 2002 \cite{plauborg_simple_2002} is versatile enough to be applied to hourly data series, thereby expanding its utility beyond daily temperature estimations.

% rewrite so it fitts better with the text
In the region Østfold year 2021 there is a divergence in the PLauborg models when predicting the 10 cm soil temperature, this arises as an effect from an old code used to plot the graph of this model. In the old code the NULL values was set by default to 0 meaning when calculation the difference between predicted values and ground truth it in essence created a copy of the air temperature.

\subsection{Discussion of good results of Plauborg}

It is found that incorporating historical temperature data significantly enhances the accuracy of predictions, even on an hourly scale. The coefficients for both daily and hourly predictions are noted to be less than one, which suggests that they represent an average temperature. The Fourier terms are employed to approximate the soil temperature function, as indicated in Equation \eqref{eq:soil_equation}, referenced from \citeauthor{holt_forecasting_2004}’ work \cite{holmes_estimating_2008} on estimating soil temperatures in \citeyear{holmes_estimating_2008}.

\begin{equation}
E_{\text{air,year}}(T) + e^{-z/D}\sin(\omega t - z/D + \phi)\label{eq:soil_equation}
\end{equation}

The expected value of the soil temperature is denoted by $ E_{\text{soil,year}} $, and $T$  represents the collection of time ( t ) and corresponding air temperature. As the term $ e^{z/D} $ is a constant, the estimation focuses on $ \sin(\omega t - Q) $, which is expressed as $ \sin(\omega t)\cos(Q) - \sin(Q)\cos(\omega t) $. Here, $ Q $ is $ z/D - \phi $ and is considered a constant. This leads to an extrapolation to a simple sum of sines and cosines, as the model does. The Plauborg model estimates the soil temperature equation \eqref{eq:soil_equation} with the approximation given in Equation \eqref{eq:plauborg_expand}. The inclusion of extra terms is useful to account for external factors that influence temperature, such as rainfall, soil type, and atmospheric conditions.

\begin{align}
E_{\text{air,period}}(T) + \sum \alpha_ie^{z/D}\sin(-Q_i)\cos(i\omega t_i) + \sum \beta_je^{z/D}\cos(-Q_j)\sin(i\omega t_j) + \varepsilon\label{eq:plauborg_expand}
\end{align}

The term $ E_{\text{air, period}} $ is the expected value of air temperature over a designated period, which is distinct from an annual calculation.

By focusing on shorter periods, the model can more accurately reflect the immediate environmental conditions, which is important for applications such as agricultural planning, where precise temperature forecasts can influence crop management decisions.

The differences between actual and predicted values in the Pluborg models could be due to the varying soil types at different stations. For the purpose of formulating a more precise model, it might be beneficial to incorporate a broader spectrum of meteorological measurements. These could include factors such as air pressure, humidity, and specific characteristics of the soil, like its type and texture. Additionally, the integration of non-linear variables—such as the square root of the temperature or the ratio of temperature change over a given time interval—might offer further refinement to the model’s predictive capabilities. By incorporating these enhancements, the model can better grasp the complicated interactions between different metrological, and soil factors that influence temperature readings.

\subsection{Modification of Plauborg}

The Plauborg model trained in Norway was found to only need 3 days ($t_0,t_{-1},t_{-2}$) compared to \cite{plauborg_simple_2002} that needed 4 days ($t_0,t_{-1},t_{-2},t_{-3}$). However, for the Fourier terms both models (hourly version and the daily version) required 2 sine and cosine terms. For the 20cm target the models diverge in the sense of quantity of terms. It was found that the 20cm model needs 14 sine terms and 2 cosine terms, however only needs 2 days.
\begin{figure}[H]
	\begin{subfigure}{\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/diffplot_Plauborg_day_stat_10_Innlandet_2022_TJM10}
		\caption[Plauborg daily TJM10]{The daily model of Plauborg model. The model uses daily avergae tempratures to predict soil temperatures.}
		\label{fig:diffplotplauborgdaystat10innlandet2022tjm10}
	\end{subfigure}
	\begin{subfigure}{\textwidth}
		\centering
		\includegraphics[width=0.8\linewidth]{../../results/plots/diffplot_Plauborg_stat_10_Innlandet_2022_TJM10}
		\caption[Plauborg hourly TJM10]{The hourly model of Plauborg model. The model uses hourly temperature data.}
		\label{fig:diffplotplauborgstat10innlandet2022tjm10}
	\end{subfigure}
	\caption{Comperasion of daily versus hourly predictions}
\end{figure}

The modification to Plauborg's model is minor, by replacing the $\omega$ with a larger coefficient it can be used with hourly data. As seen in figure \ref{fig:diffplotplauborgstat10innlandet2022tjm10} the variation is stronger than \ref{fig:diffplotplauborgdaystat10innlandet2022tjm10} however the overall performance is comparable as seen in table \ref{tab:Plauborg:day:10} and table \ref{tab:Plauborg:hour:10}. 

\begin{table}[H]
	\centering
	\resizebox{\textwidth}{!}{
		\input{tables/table_Plauborg_stat_10.tex}
	}
	\caption{Hourly Plauborg model results.}
	\label{tab:plauborg_hour_res}
\end{table}

\begin{table}[H]
	\centering
	\resizebox{\textwidth}{!}{
		\input{tables/table_Plauborg_day_stat_10.tex}
	}
	\caption{Daily Plauborg model results.}
	\label{tab:plauborg_day_res}
\end{table}

With modification to the model to accept hourly data it still preforms approximately as well as the daily data version. With a average error of $0.597^\circ C \pm 2.529^\circ C$ for TJM10 and $0.528^\circ C \pm 2.676^\circ C$ for TJM20. It was found that the modified Plauborg model only needs 2 sine terms to make a good prediction and 12h of air temperature which would translate to half a day instead of 3 days.
 
\subsubsection{RNN results compared to other studies}
 
The findings of this research are consistent with the numerical trends observed in previous studies, such as those conducted by \cite{feng_estimation_2019,citakoglu_comparison_2017,li_attention-aware_2022,li_gans-lstm_2020,wang_modeling_2022}. However, it is noteworthy that these studies incorporated a broader set of predictive features—including air moisture, rainfall, solar radiation, and wind speed—to enhance the accuracy of soil temperature predictions. The inclusion of these additional meteorological parameters has been shown to improve model performance, underscoring the importance of a comprehensive feature set in predictive modelling of soil temperature.

\subsection{Deep learning model performance}

It is observed in the epoch graphs of the deep learning models that there is a boost in learning rate when implementing the bidirectional technique rather than learning  from the data in one time direction. Similarly, it is found that the general performance of the models gets improved by making them bidirectional.

By analysing the model performance table in section \ref{sec:result} it shows that BiLSTM did better than the other models in terms predicting soil temperature at 10 cm depth, however BiGRU did perform better at 20 cm depth.

\subsection{Future work}

The models chosen in this study is not a representative sample of current knowledge of soil temperature modelling, and this study did not aim for optimizing the models beyond what the original authors have already done with the exception for base models used for comparison purposes. A more comprehensive is needed of more complex models that utilises cutting edge technologies, techniques, and theory. One of which is logic based models, for instance ASPER\cite{le_asper_2023} that tries to incorporate logical descriptions of the problem and limits the model for better or equal results based on fewer samples\cite{machot_bridging_2023}. Another approach is to use the newest deep learning method of the attention mechanism\cite{vaswani_attention_2017} combined with recurrent neural networks to elevate the accuracy and speed of the model. As the author of the paper \cite{li_attention-aware_2022} has show some promise with that approach.

Furthermore, the models presented in this study are not optimised as far as they can as there are more parameters one can include in the model, and \gls{gl:hype_param} one can fine tune to improve the predictive capability of the models such as
\begin{itemize}
	\item The type of loss function
	\item the learning rate
	\item the optimizer
	\item the activation function used
	\item weight regulation
	\item adding a dropout rate
\end{itemize}
This are a small collection of techniques that can be utilised to furter optimize the models for better predictive performance. 

There have been significant developments in model types, including \acrfull{ac:asper}. ASPER combines logical statements\footnote{Statements can be thought of as formulas, natural laws, or knowledge about the solution} with deep learning models to achieve results comparable to or better than "non-logical" deep learning models, but with fewer samples \cite{le_asper_2023}. A study demonstrated that the ASPER model can reduce the required number of samples/observations by a factor of 1/1000 \cite{machot_bridging_2023} and studies that uses this knowledge based approach shows to improve the predictive ability of the model to predict soil temperatures\cite{abimbola_knowledge-guided_2021,alizamir_advanced_2020}. In an interview with the study researcher \cite{fadi_al_machot_discussion_2024}, it was found that while the model requires strict rules, it is possible to incorporate Bayesian statistics to enhance its generality for various applications. By relaxing the ruleset and acknowledging that the given rules may not be 100\% accurate, the model can be adapted to other applications using approximation rule-sets. Its the belife of the author of current study that this model can be adapted to soil temperature prediction when incorporating Bayesian statistics.

Additionally, attention-awareness, a method developed by the Google cooperation \cite{vaswani_attention_2017} also used in ChatGPT and other modern AI technologies, has been employed to predict soil temperatures and soil moisture\cite{li_attention-aware_2022} and has shown promising results in predicting soil temperatures by dynamically putting emphases on some of the features, particular days, and combinations of these when predicting. 